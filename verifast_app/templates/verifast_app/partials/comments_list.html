<!-- Comments List Partial -->
{% load i18n %}

<div id="comments-list">
{% for comment in comments %}
    <div class="comment">
        <div class="comment-header">
            <strong>{{ comment.user.username }}</strong>
            <span class="comment-date">{{ comment.timestamp|date:"M j, Y g:i A" }}</span>
        </div>
        <div class="comment-content">
            {{ comment.content }}
        </div>
        <div class="comment-actions">
            {% if user.is_authenticated %}
                <button class="interaction-btn bronze" 
                        hx-post="{% url 'verifast_app:comment_interact' comment.id %}"
                        hx-vals='{"type": "bronze"}'
                        hx-target="#comments-list"
                        hx-swap="innerHTML">
                    {% trans "Bronze" %} (5 XP)
                </button>
                <button class="interaction-btn silver"
                        hx-post="{% url 'verifast_app:comment_interact' comment.id %}"
                        hx-vals='{"type": "silver"}'
                        hx-target="#comments-list"
                        hx-swap="innerHTML">
                    {% trans "Silver" %} (15 XP)
                </button>
                <button class="interaction-btn gold"
                        hx-post="{% url 'verifast_app:comment_interact' comment.id %}"
                        hx-vals='{"type": "gold"}'
                        hx-target="#comments-list"
                        hx-swap="innerHTML">
                    {% trans "Gold" %} (30 XP)
                </button>
            {% endif %}
        </div>
        
        <!-- Nested replies -->
        {% if comment.replies.exists %}
            <div class="comment-replies">
                {% for reply in comment.replies.all %}
                    <div class="comment reply">
                        <div class="comment-header">
                            <strong>{{ reply.user.username }}</strong>
                            <span class="comment-date">{{ reply.timestamp|date:"M j, Y g:i A" }}</span>
                        </div>
                        <div class="comment-content">
                            {{ reply.content }}
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
{% empty %}
    <p class="no-comments">{% trans "No comments yet. Be the first to share your thoughts!" %}</p>
{% endfor %}
</div>